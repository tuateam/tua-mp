!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.TuaWx={})}(this,function(t){"use strict";var d={enumerable:!0,configurable:!0},s="__TUA_PATH",v=function(t){return"function"==typeof t},y=function(t,e){return""===t?e:t+"."+e},b=function(e,r){Object.keys(e).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))})},h=Array.prototype,j=Object.create(h),a=["pop","push","sort","shift","splice","unshift","reverse"],c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},m=null,P=function(d,b){return function(t){var e,r,n,o,a,c,i,u,f=t.path,l=t.newVal,p=t.oldVal,s=t.isArrDirty,y=void 0!==s&&s;m=O({},m,(n=l,(r=f)in(e={})?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e)),y&&(c=(o={obj:d,val:l,path:f}).obj,i=o.path,u=o.val,(a=i,a.split(".").map(function(t){return t.split(/\[(.*?)\]/).filter(function(t){return t})}).reduce(function(t,e){return t.concat(e)},[])).reduce(function(t,e,r,n){if(r!==n.length-1)return t[e]||(t[e]=/\d/.test(e)?[]:{}),t[e];t[e]=u},c)),Promise.resolve().then(function(){if(m){d.setData(O({},d.$computed,m));var t=b[f];v(t)&&t.call(d,m[f],p),m=null}})}},_=function(p){return function r(n){var t,e,i,u,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(Array.isArray(n)){var o=n.map(function(t,e){return r(t,f+"["+e+"]")});return o[s]=f,e=(t={arr:o,observeDeep:r,asyncSetData:p}).arr,i=t.observeDeep,u=t.asyncSetData,a.forEach(function(a){var c=h[a];j[a]=function(){for(var t=this[s],e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var o=c.apply(this,r);return u("pop"===a?{path:t,newVal:this}:{path:t,newVal:i(this,t),isArrDirty:!0}),o}}),Object.setPrototypeOf?Object.setPrototypeOf(e,j):"__proto__"in e?e.__proto__=j:b(j,e),e}if("object"===(void 0===n?"undefined":c(n))){var l=Object.create(null);return Object.defineProperty(l,s,{enumerable:!1,value:f}),Object.keys(n).forEach(function(t){var e,o,a,c,i,u;/^__.*__$/.test(t)||(e={obj:l,key:t,val:r(n[t],y(f,t)),observeDeep:r,asyncSetData:p},o=e.obj,a=e.key,c=e.val,i=e.observeDeep,u=e.asyncSetData,Object.defineProperty(o,a,O({},d,{get:function(){return c},set:function(t){if(t!==c){var e=c,r=o[s]||"",n=y(r,a);c=i(t,n),u({path:n,newVal:t,oldVal:e})}}})))}),l}return n}};console.log("[TUA-MP]: Version 0.5.2");t.TuaPage=function(t){var e=t.data,r=t.watch,p=void 0===r?{}:r,n=t.methods,o=void 0===n?{}:n,a=t.computed,s=void 0===a?{}:a,y=function(t,e){var r={};for(var n in t)0<=e.indexOf(n)||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}(t,["data","watch","methods","computed"]),c=v(e)?e():e;return Page(O({},y,o,{data:c,onLoad:function(){var t,e,o,a,c,i,r=P(this,p),n=_(r);e=n((t=this).data),t.$data=e,b(e,t),o=this,a=s,c=p,i=Object.create(null),Object.keys(a).forEach(function(r){var n=a[r].call(o);Object.defineProperty(i,r,O({},d,{get:function(){var t=a[r].call(o),e=c[r];return v(e)&&t!==n&&e.call(o,t,n),n=t},set:function(){console.warn("[TUA-MP]: 请勿对 computed 属性 "+r+" 赋值，它应该由 data 中的依赖自动计算得到！")}}))}),o.$computed=i,b(i,o),o.setData(i);for(var u=arguments.length,f=Array(u),l=0;l<u;l++)f[l]=arguments[l];y.onLoad&&y.onLoad.apply(this,f)}}))},Object.defineProperty(t,"__esModule",{value:!0})});
